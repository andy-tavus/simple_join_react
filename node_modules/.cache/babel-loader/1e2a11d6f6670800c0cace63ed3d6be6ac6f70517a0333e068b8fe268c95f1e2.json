{"ast":null,"code":"var _jsxFileName = \"/Users/andywertner/Documents/dailyco/simple_join_react/src/App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport DailyIframe from '@daily-co/daily-js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const [callFrame, setCallFrame] = useState(null);\n  const [participants, setParticipants] = useState([]);\n  const [error, setError] = useState(null);\n  const videoContainerRef = useRef(null);\n  useEffect(() => {\n    return () => {\n      // Clean up the call when component unmounts\n      if (callFrame) {\n        callFrame.destroy();\n      }\n    };\n  }, [callFrame]);\n  const subscribeToRoom = async roomId => {\n    try {\n      if (callFrame) {\n        callFrame.destroy();\n      }\n      setError(null);\n      const daily = DailyIframe.createFrame(videoContainerRef.current, {\n        iframeStyle: {\n          width: '100%',\n          height: '100%',\n          border: 'none',\n          backgroundColor: 'transparent'\n        },\n        showLeaveButton: true,\n        url: `https://tavus.daily.co/${roomId}`\n      });\n\n      // Set up event handlers\n      daily.on('participant-joined', event => {\n        console.log('Participant joined:', event.participant);\n        updateParticipants(daily);\n      });\n      daily.on('participant-left', () => {\n        updateParticipants(daily);\n      });\n      daily.on('participant-updated', () => {\n        updateParticipants(daily);\n      });\n      daily.on('error', error => {\n        console.error('Daily.co error:', error);\n        setError(error.errorMsg || 'An error occurred with the video call');\n      });\n\n      // Wait for the frame to be loaded\n      await daily.load();\n\n      // Instead of joining, we'll subscribe to the room\n      await daily.setSubscribeToTracksAutomatically(true);\n      await daily.setInputDevices({\n        audio: false,\n        video: false\n      });\n      await daily.join({\n        subscribeToTracksAutomatically: true,\n        audio: false,\n        video: false\n      });\n      setCallFrame(daily);\n    } catch (err) {\n      console.error('Error subscribing to room:', err);\n      setError(err.message || 'Failed to subscribe to the room');\n    }\n  };\n  const updateParticipants = daily => {\n    try {\n      const participantData = daily.participants();\n      if (participantData) {\n        const participantList = Object.values(participantData);\n        setParticipants(participantList);\n      }\n    } catch (err) {\n      console.error('Error updating participants:', err);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"app\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"controls\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"Enter room ID\",\n        onKeyPress: e => e.key === 'Enter' && subscribeToRoom(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: e => subscribeToRoom(document.querySelector('input').value),\n        children: \"Subscribe to Room\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-message\",\n      style: {\n        color: 'red',\n        marginBottom: '10px'\n      },\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"video-container\",\n      ref: videoContainerRef,\n      style: {\n        width: '800px',\n        height: '600px'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"participants-list\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: [\"Participants (\", participants.length, \")\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        children: participants.map(participant => /*#__PURE__*/_jsxDEV(\"li\", {\n          children: [participant.user_name || 'Guest', participant.local ? ' (You)' : '']\n        }, participant.session_id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"NEz8s7g4ag7C5UWiNsQeEBtMSXc=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useRef","DailyIframe","jsxDEV","_jsxDEV","App","_s","callFrame","setCallFrame","participants","setParticipants","error","setError","videoContainerRef","destroy","subscribeToRoom","roomId","daily","createFrame","current","iframeStyle","width","height","border","backgroundColor","showLeaveButton","url","on","event","console","log","participant","updateParticipants","errorMsg","load","setSubscribeToTracksAutomatically","setInputDevices","audio","video","join","subscribeToTracksAutomatically","err","message","participantData","participantList","Object","values","className","children","type","placeholder","onKeyPress","e","key","target","value","fileName","_jsxFileName","lineNumber","columnNumber","onClick","document","querySelector","style","color","marginBottom","ref","length","map","user_name","local","session_id","_c","$RefreshReg$"],"sources":["/Users/andywertner/Documents/dailyco/simple_join_react/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport DailyIframe from '@daily-co/daily-js';\n\nfunction App() {\n  const [callFrame, setCallFrame] = useState(null);\n  const [participants, setParticipants] = useState([]);\n  const [error, setError] = useState(null);\n  const videoContainerRef = useRef(null);\n\n  useEffect(() => {\n    return () => {\n      // Clean up the call when component unmounts\n      if (callFrame) {\n        callFrame.destroy();\n      }\n    };\n  }, [callFrame]);\n\n  const subscribeToRoom = async (roomId) => {\n    try {\n      if (callFrame) {\n        callFrame.destroy();\n      }\n\n      setError(null);\n\n      const daily = DailyIframe.createFrame(videoContainerRef.current, {\n        iframeStyle: {\n          width: '100%',\n          height: '100%',\n          border: 'none',\n          backgroundColor: 'transparent',\n        },\n        showLeaveButton: true,\n        url: `https://tavus.daily.co/${roomId}`,\n      });\n\n      // Set up event handlers\n      daily.on('participant-joined', (event) => {\n        console.log('Participant joined:', event.participant);\n        updateParticipants(daily);\n      });\n\n      daily.on('participant-left', () => {\n        updateParticipants(daily);\n      });\n\n      daily.on('participant-updated', () => {\n        updateParticipants(daily);\n      });\n\n      daily.on('error', (error) => {\n        console.error('Daily.co error:', error);\n        setError(error.errorMsg || 'An error occurred with the video call');\n      });\n\n      // Wait for the frame to be loaded\n      await daily.load();\n\n      // Instead of joining, we'll subscribe to the room\n      await daily.setSubscribeToTracksAutomatically(true);\n      await daily.setInputDevices({ audio: false, video: false });\n      await daily.join({\n        subscribeToTracksAutomatically: true,\n        audio: false,\n        video: false,\n      });\n\n      setCallFrame(daily);\n    } catch (err) {\n      console.error('Error subscribing to room:', err);\n      setError(err.message || 'Failed to subscribe to the room');\n    }\n  };\n\n  const updateParticipants = (daily) => {\n    try {\n      const participantData = daily.participants();\n      if (participantData) {\n        const participantList = Object.values(participantData);\n        setParticipants(participantList);\n      }\n    } catch (err) {\n      console.error('Error updating participants:', err);\n    }\n  };\n\n  return (\n    <div className=\"app\">\n      <div className=\"controls\">\n        <input \n          type=\"text\" \n          placeholder=\"Enter room ID\" \n          onKeyPress={(e) => e.key === 'Enter' && subscribeToRoom(e.target.value)}\n        />\n        <button onClick={(e) => subscribeToRoom(document.querySelector('input').value)}>\n          Subscribe to Room\n        </button>\n      </div>\n      \n      {error && (\n        <div className=\"error-message\" style={{ color: 'red', marginBottom: '10px' }}>\n          {error}\n        </div>\n      )}\n      \n      <div className=\"video-container\" ref={videoContainerRef} style={{ width: '800px', height: '600px' }}></div>\n      \n      <div className=\"participants-list\">\n        <h3>Participants ({participants.length})</h3>\n        <ul>\n          {participants.map((participant) => (\n            <li key={participant.session_id}>\n              {participant.user_name || 'Guest'} \n              {participant.local ? ' (You)' : ''}\n            </li>\n          ))}\n        </ul>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}